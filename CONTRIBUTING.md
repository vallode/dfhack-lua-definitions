
# Contributing

To get up and running you'll need Ruby installed on your system. Once you do, run the following commands after cloning the repository:

```sh
bundle install
git submodule update --remote
ruby lib/generate.rb
```

If everything went well there should be no errors. When developing you'll need to re-run the last command to see changes.

The aim of this project is to fully automatically generate LuaLS definition files for the entirety of the DFHack Lua environment. This means parsing XML files in df-structures, Lua files present in the DFHack library, and C++ files defining metatables for use in Lua.

Files generated by the script ([`generate.rb`](lib/generate.rb)) are marked as such on their first line. Those files should never be edited by hand as any changes will be lost when the script is next ran.

Once set up, you can follow the normal "installation" instructions, but simply point the language server at the [dist](dist) folder.

Structure files are output to the base [dist](dist) directory, only the [base.lua](dist/library/base.lua) file is meant to be manually edited.

## VSCode

Using the `Build Task` shortcut `Ctrl+Shift+B` you can automatically run [`generate.rb`](lib/generate.rb).

## LuaLS

The [Lua language server](https://github.com/LuaLS/lua-language-server) provides extra functionality for code editors to make editing Lua easier. Part of this is dynamic type hinting, which can be helpful in the discovery and documentation of code. It can also provide diagnostic errors and warnings when types are misused.
